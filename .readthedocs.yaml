version: 2

build:
    os: ubuntu-22.04
    tools:
        python: "mambaforge-22.9"
    jobs:
        post_create_environment: 
          #- source etc/conda/activate.d/openjdk_activate.sh
          - mamba info
          - mamba list --verbose
          - find /home/docs/checkouts/readthedocs.org/user_builds/r5py/conda/ | grep openjdk
          - cat /home/docs/checkouts/readthedocs.org/user_builds/r5py/conda/*/etc/conda/activate.d/openjdk_activate.sh
          - export JAVA_HOME="${CONDA_PREFIX}/lib/jvm"
          - export JAVA_LD_LIBRARY_PATH="${JAVA_HOME}/lib/server"
          - echo $JAVA_HOME

conda:
    environment: ci/python_311_dev.yaml

python:
    install:
        - method: pip
          path: .
          extra_requirements: 
            - docs

sphinx:
    configuration: docs/conf.py
    fail_on_warning: true
